(()=>{var e={383:e=>{e.exports={EventBus:class{bus=null;constructor(e){let[t]=document.getElementsByTagName("body");this.bus=t.appendChild(new Comment(e))}on(e,t){this.bus.addEventListener(e,t)}off(e,t){this.bus.removeEventListener(e,t)}emit(e,t){this.bus.dispatchEvent(new CustomEvent(e,{detail:t}))}}}},17:e=>{class t{static dimensions={width:100,height:30};static moveOffset=25;eventBus=null;id="";position={top:0,left:0};eventHandlers={missileMoved:e=>{this.checkMissile(e.detail)}};constructor(e,i){this.eventBus=i,this.id="eventer-"+Math.random().toString(36).substring(10),this.position={top:e.top,left:e.left},this.eventBus.emit("EventerCreated",{id:this.id,dimensions:t.dimensions,position:this.position}),this.eventBus.on("MissileMoved",this.eventHandlers.missileMoved)}destructor(){this.eventBus.off("MissileMoved",this.eventHandlers.missileMoved)}checkMissile(e){this.position.top+t.dimensions.height>=e.position.top&&this.position.left<=e.position.left&&this.position.left+t.dimensions.width>e.position.left&&(this.eventBus.emit("MissileDestroyed",{id:e.id}),this.eventBus.emit("EventerDestroyed",{id:this.id}))}}e.exports={Eventer:t}},100:(e,t,i)=>{const{Eventer:s}=i(17);class n{static count=36;static itemsInRow=6;static separation={top:20,left:20};eventBus=null;eventers={};constructor(e){this.eventBus=e;let t=this.calculateInitialPosition(),i={top:t.top,left:t.left};for(let e=1;e<=n.count;e++){let o=new s(i,this.eventBus);e>0&&e%n.itemsInRow==0?(i.top=i.top+s.dimensions.height+n.separation.top,i.left=t.left):i.left=i.left+s.dimensions.width+n.separation.left,this.eventers[o.id]=o}this.eventBus.on("EventerDestroyed",(e=>{this.eventers[e.detail.id].destructor(),delete this.eventers[e.detail.id]}))}calculateInitialPosition(){let e=document.getElementById("canvas").getBoundingClientRect(),t=n.separation.top,i=n.count/n.itemsInRow*s.dimensions.width,o=(n.count/n.itemsInRow-1)*n.separation.left;return{top:t,left:(e.width-(i+o))/2}}}e.exports={Eventers:n}},620:(e,t,i)=>{const{Player:s}=i(4),{Eventers:n}=i(100);e.exports={Game:class{player=null;eventers={};constructor(e){this.player=new s(e),this.eventers=new n(e)}}}},174:e=>{class t{static dimensions={width:3,height:8};static moveOffset=10;eventBus=null;id="";position={top:0,left:0};eventHandlers={tick:e=>{this.move()}};constructor(e,i,s){this.eventBus=s,this.id="missile-"+Math.random().toString(36).substring(10),this.position=this.calculateInitialPosition(e,i),this.eventBus.on("tick",this.eventHandlers.tick),this.eventBus.emit("MissileFired",{id:this.id,dimensions:t.dimensions,position:this.position})}destructor(){this.eventBus.off("tick",this.eventHandlers.tick)}calculateInitialPosition(e,i){return{top:e.top-t.dimensions.height,left:e.left+i.width/2}}move(){let e=this.position.top-t.moveOffset;e>0?(this.position.top=e,this.eventBus.emit("MissileMoved",{id:this.id,position:this.position})):this.eventBus.emit("MissileDestroyed",{id:this.id})}}e.exports={Missile:t}},4:(e,t,i)=>{const{Missile:s}=i(174);class n{static dimensions={width:100,height:30};static moveOffset=25;eventBus=null;position={left:0,top:0};missiles={};eventHandlers={moveLeft:e=>{this.moveLeft()},moveRight:e=>{this.moveRight()},fire:e=>{this.fire()}};constructor(e){this.eventBus=e,this.position=this.calculateInitialPosition(),this.eventBus.on("Input:ArrowLeft",this.eventHandlers.moveLeft),this.eventBus.on("Input:ArrowRight",this.eventHandlers.moveRight),this.eventBus.on("Input:Space",this.eventHandlers.fire),this.eventBus.on("MissileDestroyed",(e=>{this.missiles[e.detail.id].destructor(),delete this.missiles[e.detail.id]})),this.eventBus.emit("PlayerCreated",{dimensions:n.dimensions,position:this.position})}calculateInitialPosition(){let e=document.getElementById("canvas").getBoundingClientRect();return{top:e.height-n.dimensions.height-20,left:(e.width-n.dimensions.width)/2}}moveLeft(){let e=this.position.left-n.moveOffset;e>0&&(this.position.left=e),this.eventBus.emit("PlayerMoved",{position:this.position})}moveRight(){let e=this.position.left+n.moveOffset;e+n.dimensions.width<=document.getElementById("canvas").offsetWidth&&(this.position.left=e),this.eventBus.emit("PlayerMoved",{position:this.position})}fire(){let e=new s(this.position,n.dimensions,this.eventBus);this.missiles[e.id]=e}}e.exports={Player:n}},568:e=>{e.exports={Renderer:class{canvas=null;player=null;constructor(e){this.eventBus=e,this.createCanvas(),this.eventBus.on("PlayerCreated",(e=>{this.createPlayer(e)})),this.eventBus.on("PlayerMoved",(e=>{this.movePlayer(e)})),this.eventBus.on("MissileFired",(e=>{this.createMissile(e)})),this.eventBus.on("MissileMoved",(e=>{this.moveMissile(e)})),this.eventBus.on("MissileDestroyed",(e=>{this.destroyMissile(e)})),this.eventBus.on("EventerCreated",(e=>{this.createEventer(e)})),this.eventBus.on("EventerDestroyed",(e=>{this.destroyEventer(e)}))}createCanvas(){this.canvas=document.createElement("div"),this.canvas.id="canvas",this.canvas.style.width=window.innerWidth+"px",this.canvas.style.height=window.innerHeight+"px";let[e]=document.getElementsByTagName("body");e.appendChild(this.canvas)}createPlayer(e){this.player=document.createElement("div"),this.player.id="player",this.player.style.width=e.detail.dimensions.width+"px",this.player.style.height=e.detail.dimensions.height+"px",this.player.style.top=e.detail.position.top+"px",this.player.style.left=e.detail.position.left+"px",this.canvas.append(this.player)}movePlayer(e){this.player.style.left=e.detail.position.left+"px"}createMissile(e){let t=document.createElement("div");t.id=e.detail.id,t.className="missile",t.style.width=e.detail.dimensions.width+"px",t.style.height=e.detail.dimensions.height+"px",t.style.top=e.detail.position.top+"px",t.style.left=e.detail.position.left+"px",this.canvas.append(t)}moveMissile(e){let t=document.getElementById(e.detail.id);t&&(t.style.top=e.detail.position.top+"px")}destroyMissile(e){let t=document.getElementById(e.detail.id);t&&this.canvas.removeChild(t)}createEventer(e){let t=document.createElement("div");t.id=e.detail.id,t.className="eventer",t.style.width=e.detail.dimensions.width+"px",t.style.height=e.detail.dimensions.height+"px",t.style.top=e.detail.position.top+"px",t.style.left=e.detail.position.left+"px",this.canvas.append(t)}destroyEventer(e){let t=document.getElementById(e.detail.id);t&&this.canvas.removeChild(t)}}}}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,i),o.exports}(()=>{const{EventBus:e}=i(383),{Game:t}=i(620),{Renderer:s}=i(568);window.onload=()=>{let i=new e("event-bus");new e("command-bus"),window.renderer=new s(i),window.game=new t(i),window.onkeydown=e=>{i.emit("Input:"+e.code)},setInterval((()=>{i.emit("tick")}),50)}})()})();