(()=>{var e={17:(e,t,i)=>{const{generateRandomId:s}=i(550);class n{static dimensions={width:100,height:30};static moveOffset=25;eventBus=null;id="";position={top:0,left:0};eventHandlers={missileMoved:e=>{this.checkMissileCollision(e.detail)}};constructor(e,t){this.eventBus=t,this.id=s("eventer"),this.position={top:e.top,left:e.left},this.eventBus.emit("EventerCreated",{id:this.id,dimensions:n.dimensions,position:this.position}),this.eventBus.on("MissileMoved",this.eventHandlers.missileMoved)}destructor(){this.eventBus.off("MissileMoved",this.eventHandlers.missileMoved)}checkMissileCollision(e){this.position.top+n.dimensions.height>=e.position.top&&this.position.left<=e.position.left&&this.position.left+n.dimensions.width>e.position.left&&(this.eventBus.emit("MissileDestroyed",{id:e.id}),this.eventBus.emit("EventerDestroyed",{id:this.id}))}}e.exports={Eventer:n}},100:(e,t,i)=>{const{Eventer:s}=i(17);class n{static count=36;static itemsInRow=6;static separation={top:20,left:20};eventBus=null;eventers={};constructor(e,t){this.eventBus=t;let i=this.calculateInitialPosition(e),o={top:i.top,left:i.left};for(let e=1;e<=n.count;e++){let t=new s(o,this.eventBus);e>0&&e%n.itemsInRow==0?(o.top=o.top+s.dimensions.height+n.separation.top,o.left=i.left):o.left=o.left+s.dimensions.width+n.separation.left,this.eventers[t.id]=t}this.eventBus.on("EventerDestroyed",(e=>{this.eventers[e.detail.id].destructor(),delete this.eventers[e.detail.id]}))}calculateInitialPosition(e){let t=n.separation.top,i=n.count/n.itemsInRow*s.dimensions.width,o=(n.count/n.itemsInRow-1)*n.separation.left;return{top:t,left:(e.width-(i+o))/2}}}e.exports={Eventers:n}},620:(e,t,i)=>{const{Player:s}=i(4),{Eventers:n}=i(100),{Missile:o}=i(174);e.exports={Game:class{eventBus=null;player=null;eventers={};missiles={};eventHandlers={playerFired:e=>{this.createMisile(e.detail.position)}};constructor(e,t){this.eventBus=t,this.player=new s(e,t),this.eventers=new n(e,t),this.eventBus.on("PlayerFired",this.eventHandlers.playerFired),this.eventBus.on("MissileDestroyed",(e=>{this.missiles[e.detail.id].destructor(),delete this.missiles[e.detail.id]}))}createMisile(e){let t=new o(e,s.dimensions,this.eventBus);this.missiles[t.id]=t}}}},498:e=>{e.exports={MessageBus:class{bus=null;constructor(e){let[t]=document.getElementsByTagName("body");this.bus=t.appendChild(new Comment(e))}on(e,t){this.bus.addEventListener(e,t)}off(e,t){this.bus.removeEventListener(e,t)}emit(e,t){this.bus.dispatchEvent(new CustomEvent(e,{detail:t}))}}}},174:(e,t,i)=>{const{generateRandomId:s}=i(550);class n{static dimensions={width:3,height:8};static moveOffset=10;eventBus=null;id="";position={top:0,left:0};eventHandlers={tick:e=>{this.move()}};constructor(e,t,i){this.eventBus=i,this.id=s("missile"),this.position=this.calculateInitialPosition(e,t),this.eventBus.on("tick",this.eventHandlers.tick),this.eventBus.emit("MissileFired",{id:this.id,dimensions:n.dimensions,position:this.position})}destructor(){this.eventBus.off("tick",this.eventHandlers.tick)}calculateInitialPosition(e,t){return{top:e.top-n.dimensions.height,left:e.left+t.width/2}}move(){let e=this.position.top-n.moveOffset;e>0?(this.position.top=e,this.eventBus.emit("MissileMoved",{id:this.id,position:this.position})):this.eventBus.emit("MissileDestroyed",{id:this.id})}}e.exports={Missile:n}},4:e=>{class t{static dimensions={width:100,height:30};static moveOffset=25;canvasDimensions=null;eventBus=null;position={left:0,top:0};eventHandlers={moveLeft:e=>{this.moveLeft()},moveRight:e=>{this.moveRight()},fire:e=>{this.fire()}};constructor(e,i){this.canvasDimensions=e,this.eventBus=i,this.position=this.initializePosition(this.canvasDimensions),this.eventBus.on("Input:ArrowLeft",this.eventHandlers.moveLeft),this.eventBus.on("Input:ArrowRight",this.eventHandlers.moveRight),this.eventBus.on("Input:Space",this.eventHandlers.fire),this.eventBus.emit("PlayerCreated",{dimensions:t.dimensions,position:this.position})}initializePosition(e){return{top:e.height-t.dimensions.height-20,left:(e.width-t.dimensions.width)/2}}moveLeft(){let e=this.position.left-t.moveOffset;e>0&&(this.position.left=e),this.eventBus.emit("PlayerMoved",{position:this.position})}moveRight(){let e=this.position.left+t.moveOffset;e+t.dimensions.width<=this.canvasDimensions.right&&(this.position.left=e),this.eventBus.emit("PlayerMoved",{position:this.position})}fire(){this.eventBus.emit("PlayerFired",{position:this.position})}}e.exports={Player:t}},568:e=>{e.exports={Renderer:class{canvas=null;player=null;constructor(e){this.eventBus=e,this.createCanvas(),this.eventBus.on("PlayerCreated",(e=>{this.createPlayer(e)})),this.eventBus.on("PlayerMoved",(e=>{this.movePlayer(e)})),this.eventBus.on("MissileFired",(e=>{this.createMissile(e)})),this.eventBus.on("MissileMoved",(e=>{this.moveMissile(e)})),this.eventBus.on("MissileDestroyed",(e=>{this.destroyMissile(e)})),this.eventBus.on("EventerCreated",(e=>{this.createEventer(e)})),this.eventBus.on("EventerDestroyed",(e=>{this.destroyEventer(e)}))}canvasDimensions(){return document.getElementById("canvas").getBoundingClientRect()}createCanvas(){this.canvas=document.createElement("div"),this.canvas.id="canvas",this.canvas.style.width=window.innerWidth+"px",this.canvas.style.height=window.innerHeight+"px";let[e]=document.getElementsByTagName("body");e.appendChild(this.canvas)}createPlayer(e){this.player=document.createElement("div"),this.player.id="player",this.player.style.width=e.detail.dimensions.width+"px",this.player.style.height=e.detail.dimensions.height+"px",this.player.style.top=e.detail.position.top+"px",this.player.style.left=e.detail.position.left+"px",this.canvas.append(this.player)}movePlayer(e){this.player.style.left=e.detail.position.left+"px"}createMissile(e){let t=document.createElement("div");t.id=e.detail.id,t.className="missile",t.style.width=e.detail.dimensions.width+"px",t.style.height=e.detail.dimensions.height+"px",t.style.top=e.detail.position.top+"px",t.style.left=e.detail.position.left+"px",this.canvas.append(t)}moveMissile(e){let t=document.getElementById(e.detail.id);t&&(t.style.top=e.detail.position.top+"px")}destroyMissile(e){let t=document.getElementById(e.detail.id);t&&this.canvas.removeChild(t)}createEventer(e){let t=document.createElement("div");t.id=e.detail.id,t.className="eventer",t.style.width=e.detail.dimensions.width+"px",t.style.height=e.detail.dimensions.height+"px",t.style.top=e.detail.position.top+"px",t.style.left=e.detail.position.left+"px",this.canvas.append(t)}destroyEventer(e){let t=document.getElementById(e.detail.id);t&&this.canvas.removeChild(t)}}}},550:e=>{e.exports={generateRandomId:function(e){let t="";return e&&(t+=e+"-"),t+=Math.random().toString(36).substring(2),t}}}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,i),o.exports}(()=>{const{MessageBus:e}=i(498),{Game:t}=i(620),{Renderer:s}=i(568);window.onload=()=>{let i=new e("events");new e("commands"),window.renderer=new s(i),window.game=new t(window.renderer.canvasDimensions(),i),window.onkeydown=e=>{i.emit("Input:"+e.code)},setInterval((()=>{i.emit("tick")}),50)}})()})();